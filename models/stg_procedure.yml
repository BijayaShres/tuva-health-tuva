version: 2

models:
    - name: stg_procedure
      description: Each row is a single procedure for a single patient
      columns:
          - name: encounter_id
            description: "Unique encounter id"
            tests:
                - not_null
                - relationships:
                    to: ref('stg_encounter')
                    field: encounter_id

          - name: code_type
            description: "Type of procedure code (e.g. icd-10-pcs)"
            tests:
                - not_null
                - valid_values:
                    lookup_table: ref('code_types')
                    lookup_column: description

          - name: procedure_code
            description: "Procedure code"
            tests:
                - not_null

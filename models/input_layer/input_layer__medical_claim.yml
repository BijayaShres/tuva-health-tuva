version: 2
models:
- name: input_layer__medical_claim
  description: > 
      Mapping check to make sure all columns are mapped appropriately into the input layer.
      The medical_claim table contains information on healthcare services and 
      supplies provided to patients, billed by providers, and paid for by health 
      insurers. It includes information on the provider who rendered the 
      service, the amount paid for the service by the health insurer, and the 
      underlying reason for the service (i.e. diagnosis).
  tests:
    - dbt_utils.unique_combination_of_columns:
        combination_of_columns:
          - claim_id
          - claim_line_number
        tags: ['tuva_dqi_sev_1', 'dqi']
        config:
          severity: error
          enabled: "{{ (target.type != 'fabric') | as_bool }}"
#     A claim cannot be both professional and institutional within the same claim id.
    - dbt_expectations.expect_select_column_values_to_be_unique_within_record:
        description: 'A claim cannot be both professional and institutional within the same claim id.'
        column_list: ['claim_id', 'claim_type']
        tags: ['tuva_dqi_sev_1', 'dqi']
        config:
          severity: error
          enabled: "{{ (target.type != 'fabric') | as_bool }}"
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_input_layer{% else %}input_layer{%- endif -%}
    tags: input_layer
    materialized: view
  columns:
  - name: claim_id
    description: '{{ doc("claim_id") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          tags: ['tuva_dqi_sev_1', 'dqi']
          config:
            severity: error
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - not_null:
          tags: ['tuva_dqi_sev_1', 'dqi']
          config:
            severity: error
  - name: claim_line_number
    description: '{{ doc("claim_line_number") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          tags: ['tuva_dqi_sev_1', 'dqi']
          config:
            severity: error
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - not_null:
          tags: ['tuva_dqi_sev_1', 'dqi']
          config:
            severity: error
  - name: claim_type
    description: '{{ doc("claim_type") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - not_null:
          config:
            severity: warn
      - accepted_values:
          values: ['professional', 'institutional', 'undetermined']
          config:
            severity: warn
  - name: person_id
    description: '{{ doc("person_id") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: member_id
    description: '{{ doc("member_id") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: payer
    description: '{{ doc("payer") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: plan
    description: '{{ doc("plan") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: claim_start_date
    description: '{{ doc("claim_start_date") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: claim_end_date
    description: '{{ doc("claim_end_date") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: claim_line_start_date
    description: '{{ doc("claim_line_start_date") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: claim_line_end_date
    description: '{{ doc("claim_line_end_date") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: admission_date
    description: '{{ doc("admission_date") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: discharge_date
    description: '{{ doc("discharge_date") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: admit_source_code
    description: '{{ doc("admit_source_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - dbt_expectations.expect_column_value_lengths_to_equal:
          value: 1
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: admit_type_code
    description: '{{ doc("admit_type_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: discharge_disposition_code
    description: '{{ doc("discharge_disposition_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: place_of_service_code
    description: '{{ doc("place_of_service_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - dbt_expectations.expect_column_value_lengths_to_equal:
          value: 2
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: bill_type_code
    description: '{{ doc("bill_type_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - dbt_expectations.expect_column_value_lengths_to_be_between:
          min_value: 3
          max_value: 4
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: drg_code_type
    description: '{{ doc("drg_code_type") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - accepted_values:
          values: ['ms-drg', 'apr-drg']
          config:
            severity: warn
  - name: drg_code
    description: '{{ doc("drg_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - dbt_expectations.expect_column_value_lengths_to_equal:
          value: 3
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: revenue_center_code
    description: '{{ doc("revenue_center_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - dbt_expectations.expect_column_value_lengths_to_be_between:
          min_value: 3
          max_value: 4
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: service_unit_quantity
    description: '{{ doc("service_unit_quantity") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: hcpcs_code
    description: '{{ doc("hcpcs_code") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: hcpcs_modifier_1
    description: '{{ doc("hcpcs_modifier_1") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: hcpcs_modifier_2
    description: '{{ doc("hcpcs_modifier_2") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: hcpcs_modifier_3
    description: '{{ doc("hcpcs_modifier_3") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: hcpcs_modifier_4
    description: '{{ doc("hcpcs_modifier_4") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: hcpcs_modifier_5
    description: '{{ doc("hcpcs_modifier_5") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: rendering_npi
    description: >
          Rendering NPI for the claim (typically represents the physician or 
          entity providing services).
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: rendering_tin
    description: '{{ doc("rendering_tin") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: billing_npi
    description: >
          Billing NPI for the claim (typically represents organization billing 
          the claim).
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: billing_tin
    description: '{{ doc("billing_tin") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: facility_npi
    description: >
          Facility NPI for the claim (typically represents the facility where 
          services were performed).
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: paid_date
    description: '{{ doc("paid_date") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: paid_amount
    description: '{{ doc("paid_amount") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: allowed_amount
    description: '{{ doc("allowed_amount") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: charge_amount
    description: '{{ doc("charge_amount") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: coinsurance_amount
    description: '{{ doc("coinsurance_amount") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: copayment_amount
    description: '{{ doc("copayment_amount") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: deductible_amount
    description: '{{ doc("deductible_amount") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: total_cost_amount
    description: '{{ doc("total_cost_amount") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_type
    description: '{{ doc("diagnosis_code_type") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - accepted_values:
          values: ['icd-10-cm', 'icd-9-cm']
          config:
            severity: warn
  - name: diagnosis_code_1
    description: 1st ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_2
    description: 2nd ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_3
    description: 3rd ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_4
    description: 4th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_5
    description: 5th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_6
    description: 6th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_7
    description: 7th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_8
    description: 8th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_9
    description: 9th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_10
    description: 10th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_11
    description: 11th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_12
    description: 12th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_13
    description: 13th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_14
    description: 14th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_15
    description: 15th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_16
    description: 16th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_17
    description: 17th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_18
    description: 18th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_19
    description: 19th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_20
    description: 20th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_21
    description: 21st ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_22
    description: 22nd ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_23
    description: 23rd ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_24
    description: 24th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_code_25
    description: 25th ICD (9 or 10) CM diagnosis code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_1
    description: >
          Present on admission code for the 1st diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_2
    description: >
          Present on admission code for the 2nd diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_3
    description: >
          Present on admission code for the 3rd diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_4
    description: >
          Present on admission code for the 4th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_5
    description: >
          Present on admission code for the 5th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_6
    description: >
          Present on admission code for the 6th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_7
    description: >
          Present on admission code for the 7th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_8
    description: >
          Present on admission code for the 8th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_9
    description: >
          Present on admission code for the 9th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_10
    description: >
          Present on admission code for the 10th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_11
    description: >
          Present on admission code for the 11th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_12
    description: >
          Present on admission code for the 12th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_13
    description: >
          Present on admission code for the 13th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_14
    description: >
          Present on admission code for the 14th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_15
    description: >
          Present on admission code for the 15th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_16
    description: >
          Present on admission code for the 16th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_17
    description: >
          Present on admission code for the 17th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_18
    description: >
          Present on admission code for the 18th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_19
    description: >
          Present on admission code for the 19th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_20
    description: >
          Present on admission code for the 20th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_21
    description: >
          Present on admission code for the 21st diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_22
    description: >
          Present on admission code for the 22nd diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_23
    description: >
          Present on admission code for the 23rd diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_24
    description: >
          Present on admission code for the 24th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: diagnosis_poa_25
    description: >
          Present on admission code for the 25th diagnosis on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_type
    description: Indicates the type of procedure code (e.g. ICD-10-PCS).
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
      - accepted_values:
          values: ['icd-10-pcs', 'icd-9-pcs', 'hcpcs_level_2']
          config:
            severity: warn
  - name: procedure_code_1
    description: 1st ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_2
    description: 2nd ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_3
    description: 3rd ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_4
    description: 4th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_5
    description: 5th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_6
    description: 6th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_7
    description: 7th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_8
    description: 8th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_9
    description: 9th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_10
    description: 10th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_11
    description: 11th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_12
    description: 12th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_13
    description: 13th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_14
    description: 14th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_15
    description: 15th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_16
    description: 16th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_17
    description: 17th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_18
    description: 18th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_19
    description: 19th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_20
    description: 20th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_21
    description: 21st ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_22
    description: 22nd ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_23
    description: 23rd ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_24
    description: 24th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_code_25
    description: 25th ICD (9 or 10) procedure code on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_1
    description: Date of the 1st procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_2
    description: Date of the 2nd procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_3
    description: Date of the 3rd procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_4
    description: Date of the 4th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_5
    description: Date of the 5th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_6
    description: Date of the 6th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_7
    description: Date of the 7th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_8
    description: Date of the 8th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_9
    description: Date of the 9th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_10
    description: Date of the 10th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_11
    description: Date of the 11th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_12
    description: Date of the 12th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_13
    description: Date of the 13th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_14
    description: Date of the 14th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_15
    description: Date of the 15th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_16
    description: Date of the 16th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_17
    description: Date of the 17th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_18
    description: Date of the 18th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_19
    description: Date of the 19th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_20
    description: Date of the 20th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_21
    description: Date of the 21st procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_22
    description: Date of the 22nd procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_23
    description: Date of the 23rd procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_24
    description: Date of the 24th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: procedure_date_25
    description: Date of the 25th procedure on the claim.
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: in_network_flag
    description: '{{ doc("in_network_flag") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: data_source
    description: '{{ doc("data_source") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: file_name
    description: '{{ doc("file_name") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: file_date
    description: ''
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
  - name: ingest_datetime
    description: '{{ doc("ingest_datetime") }}'
    tests:
      - dbt_expectations.expect_column_to_exist:
          config:
            severity: warn
            enabled: "{{ (target.type != 'fabric') | as_bool }}"
